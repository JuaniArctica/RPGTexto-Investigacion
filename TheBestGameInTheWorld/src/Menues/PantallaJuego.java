/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Menues;

import javax.swing.JButton;
import javax.swing.JLabel;
import Modelo.Personaje;
import java.awt.Color;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

/**
 *
 * @author prouser
 */
public class PantallaJuego extends javax.swing.JFrame {

    private final String ruta = System.getProperties().getProperty("user.dir");

    protected Personaje refPersonaje;

    public PantallaJuego(Personaje refPersonaje) {

        initComponents();

        this.setSize(800, 600);
        this.setLocationRelativeTo(null);
        this.setDefaultCloseOperation(this.EXIT_ON_CLOSE);

        txtpHistoria.setForeground(Color.RED);

        txtpHistoria.setText("Felicitaciones! Has creado un personaje, comencemos la historia...");

        lblNombre.setText(refPersonaje.getNombre());
        lblNumeroNivel.setText(String.valueOf(refPersonaje.getNivel()));
        lblNumeroDefensa1.setText(String.valueOf(refPersonaje.getDefensa()));
        lblNumeroGolpe.setText(String.valueOf(refPersonaje.getGolpeMin()) + "/" + String.valueOf(refPersonaje.getGolpeMax()));

        PbVida.setValue(refPersonaje.getVidaMax()); //Setea como maximo de la barra la vida actual del personaje
        PbVida.setMaximum(refPersonaje.getVidaMax());

        PbExperiencia.setValue(refPersonaje.getExpMin());

        lblTextoIntro.setText("<html><br>&nbsp;<font color=#99FF99>Para vanzanzar con la historia basta con presionar<p>el boton siguiente, esperamos que lo pases de lo<p>mejor!... Suerte en la aventura!...</font><br></html>");

        txtpHistoria.setEditable(false);
        txtpHistoria.setBackground(Color.BLACK);
        txtpHistoria.setBorder(null);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnVolver = new javax.swing.JButton();
        btnAtacar = new javax.swing.JButton();
        btnHuir = new javax.swing.JButton();
        btnObservar = new javax.swing.JButton();
        btnSiguiente = new javax.swing.JButton();
        lblNombre = new javax.swing.JLabel();
        lblNumeroNivel = new javax.swing.JLabel();
        lblNivel = new javax.swing.JLabel();
        lblDescripcion = new javax.swing.JLabel();
        lblImagenObjeto = new javax.swing.JLabel();
        PbExperiencia = new javax.swing.JProgressBar();
        lblExperiencia = new javax.swing.JLabel();
        lblVida = new javax.swing.JLabel();
        PbVida = new javax.swing.JProgressBar();
        lblEnLaMira = new javax.swing.JLabel();
        lblDefensa = new javax.swing.JLabel();
        lblGolpe = new javax.swing.JLabel();
        lblNumeroGolpe = new javax.swing.JLabel();
        lblNumeroDefensa1 = new javax.swing.JLabel();
        lblTextoIntro = new javax.swing.JLabel();
        btnGolpe = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        txtpHistoria = new javax.swing.JTextPane();
        btnRegenera = new javax.swing.JButton();
        lblFondo = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setAlwaysOnTop(true);
        setBackground(new java.awt.Color(153, 153, 153));
        setResizable(false);
        setSize(new java.awt.Dimension(800, 600));
        getContentPane().setLayout(null);

        btnVolver.setText("Salir");
        btnVolver.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVolverActionPerformed(evt);
            }
        });
        getContentPane().add(btnVolver);
        btnVolver.setBounds(680, 540, 70, 25);

        btnAtacar.setText("Atacar");
        getContentPane().add(btnAtacar);
        btnAtacar.setBounds(340, 540, 80, 25);

        btnHuir.setText("Huir");
        getContentPane().add(btnHuir);
        btnHuir.setBounds(440, 540, 80, 25);

        btnObservar.setText("Ver");
        getContentPane().add(btnObservar);
        btnObservar.setBounds(240, 540, 80, 25);

        btnSiguiente.setText("Siguiente >>");
        btnSiguiente.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnSiguienteMouseClicked(evt);
            }
        });
        btnSiguiente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSiguienteActionPerformed(evt);
            }
        });
        getContentPane().add(btnSiguiente);
        btnSiguiente.setBounds(390, 40, 127, 25);

        lblNombre.setFont(new java.awt.Font("TlwgMono", 1, 24)); // NOI18N
        lblNombre.setForeground(new java.awt.Color(204, 0, 0));
        lblNombre.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblNombre.setText("Damian");
        getContentPane().add(lblNombre);
        lblNombre.setBounds(520, 20, 202, 30);

        lblNumeroNivel.setBackground(new java.awt.Color(153, 153, 153));
        lblNumeroNivel.setFont(new java.awt.Font("TlwgMono", 1, 36)); // NOI18N
        lblNumeroNivel.setForeground(new java.awt.Color(255, 255, 255));
        lblNumeroNivel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblNumeroNivel.setText("1");
        getContentPane().add(lblNumeroNivel);
        lblNumeroNivel.setBounds(733, 35, 39, 35);

        lblNivel.setFont(new java.awt.Font("TlwgMono", 1, 18)); // NOI18N
        lblNivel.setForeground(new java.awt.Color(255, 255, 255));
        lblNivel.setText("Nivel:");
        getContentPane().add(lblNivel);
        lblNivel.setBounds(663, 44, 68, 26);

        lblDescripcion.setBackground(new java.awt.Color(51, 51, 51));
        lblDescripcion.setForeground(new java.awt.Color(255, 255, 255));
        lblDescripcion.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 4));
        lblDescripcion.setOpaque(true);
        getContentPane().add(lblDescripcion);
        lblDescripcion.setBounds(580, 340, 202, 180);

        lblImagenObjeto.setBackground(new java.awt.Color(255, 255, 255));
        lblImagenObjeto.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 4));
        getContentPane().add(lblImagenObjeto);
        lblImagenObjeto.setBounds(700, 250, 80, 80);

        PbExperiencia.setForeground(new java.awt.Color(255, 255, 51));
        PbExperiencia.setToolTipText("");
        PbExperiencia.setStringPainted(true);
        getContentPane().add(PbExperiencia);
        PbExperiencia.setBounds(620, 110, 140, 20);

        lblExperiencia.setFont(new java.awt.Font("Dialog", 1, 10)); // NOI18N
        lblExperiencia.setForeground(new java.awt.Color(255, 255, 255));
        lblExperiencia.setText("Experiencia");
        getContentPane().add(lblExperiencia);
        lblExperiencia.setBounds(550, 110, 90, 20);

        lblVida.setFont(new java.awt.Font("Dialog", 1, 10)); // NOI18N
        lblVida.setForeground(new java.awt.Color(255, 255, 255));
        lblVida.setText("Vida");
        getContentPane().add(lblVida);
        lblVida.setBounds(550, 140, 70, 15);

        PbVida.setForeground(new java.awt.Color(255, 0, 0));
        PbVida.setToolTipText("");
        PbVida.setStringPainted(true);
        PbVida.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                PbVidaMouseClicked(evt);
            }
        });
        getContentPane().add(PbVida);
        PbVida.setBounds(590, 140, 170, 20);

        lblEnLaMira.setFont(new java.awt.Font("TlwgMono", 1, 16)); // NOI18N
        lblEnLaMira.setForeground(new java.awt.Color(255, 255, 255));
        lblEnLaMira.setText("En la Mira: ");
        getContentPane().add(lblEnLaMira);
        lblEnLaMira.setBounds(580, 310, 140, 23);

        lblDefensa.setFont(new java.awt.Font("Dialog", 1, 10)); // NOI18N
        lblDefensa.setForeground(new java.awt.Color(255, 255, 255));
        lblDefensa.setText("Defensa:");
        getContentPane().add(lblDefensa);
        lblDefensa.setBounds(550, 170, 60, 13);

        lblGolpe.setFont(new java.awt.Font("Dialog", 1, 10)); // NOI18N
        lblGolpe.setForeground(new java.awt.Color(255, 255, 255));
        lblGolpe.setText("Golpe:");
        getContentPane().add(lblGolpe);
        lblGolpe.setBounds(680, 170, 36, 13);

        lblNumeroGolpe.setBackground(new java.awt.Color(0, 0, 0));
        lblNumeroGolpe.setForeground(new java.awt.Color(204, 0, 0));
        lblNumeroGolpe.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblNumeroGolpe.setText("10/50");
        lblNumeroGolpe.setOpaque(true);
        getContentPane().add(lblNumeroGolpe);
        lblNumeroGolpe.setBounds(720, 170, 40, 20);

        lblNumeroDefensa1.setBackground(new java.awt.Color(0, 0, 0));
        lblNumeroDefensa1.setForeground(new java.awt.Color(0, 153, 0));
        lblNumeroDefensa1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblNumeroDefensa1.setText("3");
        lblNumeroDefensa1.setOpaque(true);
        getContentPane().add(lblNumeroDefensa1);
        lblNumeroDefensa1.setBounds(610, 170, 20, 20);

        lblTextoIntro.setForeground(new java.awt.Color(102, 255, 102));
        lblTextoIntro.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        lblTextoIntro.setVerticalAlignment(javax.swing.SwingConstants.TOP);
        getContentPane().add(lblTextoIntro);
        lblTextoIntro.setBounds(10, 10, 370, 70);

        btnGolpe.setBackground(new java.awt.Color(204, 0, 0));
        btnGolpe.setForeground(new java.awt.Color(255, 255, 255));
        btnGolpe.setText("Golpe");
        btnGolpe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGolpeActionPerformed(evt);
            }
        });
        getContentPane().add(btnGolpe);
        btnGolpe.setBounds(20, 540, 80, 25);

        jScrollPane2.setBackground(new java.awt.Color(0, 0, 0));
        jScrollPane2.setForeground(new java.awt.Color(153, 204, 0));
        jScrollPane2.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        jScrollPane2.setToolTipText("");
        jScrollPane2.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        jScrollPane2.setAutoscrolls(true);

        txtpHistoria.setEditable(false);
        txtpHistoria.setBorder(null);
        txtpHistoria.setForeground(new java.awt.Color(255, 0, 0));
        txtpHistoria.setSelectionColor(new java.awt.Color(102, 255, 102));
        jScrollPane2.setViewportView(txtpHistoria);

        getContentPane().add(jScrollPane2);
        jScrollPane2.setBounds(30, 90, 480, 440);

        btnRegenera.setBackground(new java.awt.Color(102, 255, 102));
        btnRegenera.setText("Curar");
        btnRegenera.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegeneraActionPerformed(evt);
            }
        });
        getContentPane().add(btnRegenera);
        btnRegenera.setBounds(110, 540, 80, 25);

        lblFondo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Menues/Imagenes/tablero.jpg"))); // NOI18N
        getContentPane().add(lblFondo);
        lblFondo.setBounds(0, 0, 800, 600);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    public JButton getBtnAtacar() {
        return btnAtacar;
    }

    public void setBtnAtacar(JButton btnAtacar) {
        this.btnAtacar = btnAtacar;
    }

    public JButton getBtnHuir() {
        return btnHuir;
    }

    public void setBtnHuir(JButton btnHuir) {
        this.btnHuir = btnHuir;
    }

    public JButton getBtnObservar() {
        return btnObservar;
    }

    public void setBtnObservar(JButton btnObservar) {
        this.btnObservar = btnObservar;
    }

    public JButton getBtnVolver() {
        return btnVolver;
    }

    public void setBtnVolver(JButton btnVolver) {
        this.btnVolver = btnVolver;
    }

    public JLabel getLblNivel() {
        return lblNivel;
    }

    public void setLblNivel(JLabel lblNivel) {
        this.lblNivel = lblNivel;
    }

    public JLabel getLblNombre() {
        return lblNombre;
    }

    public void setLblNombre(JLabel lblNombre) {
        this.lblNombre = lblNombre;
    }


    private void btnVolverActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVolverActionPerformed
        // TODO add your handling code here:

        Main jFrame = new Main();//"Frame2" es el nombre que  le pusiste a tu 2do jframe

        jFrame.setVisible(true);
        this.dispose();

    }//GEN-LAST:event_btnVolverActionPerformed

    private void btnSiguienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSiguienteActionPerformed

        lblTextoIntro.setVisible(false);

        incrementaTexto();


    }//GEN-LAST:event_btnSiguienteActionPerformed

    private void PbVidaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_PbVidaMouseClicked
        // TODO add your handling code here:


    }//GEN-LAST:event_PbVidaMouseClicked

    private void btnGolpeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGolpeActionPerformed
        // TODO add your handling code here:

        golpe();


    }//GEN-LAST:event_btnGolpeActionPerformed

    private void btnRegeneraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegeneraActionPerformed

        regenera();
    }//GEN-LAST:event_btnRegeneraActionPerformed

    private void btnSiguienteMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnSiguienteMouseClicked
        // TODO add your handling code here:


    }//GEN-LAST:event_btnSiguienteMouseClicked

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(PantallaJuego.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(PantallaJuego.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(PantallaJuego.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(PantallaJuego.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new PantallaJuego(new Personaje()).setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JProgressBar PbExperiencia;
    private javax.swing.JProgressBar PbVida;
    private javax.swing.JButton btnAtacar;
    private javax.swing.JButton btnGolpe;
    private javax.swing.JButton btnHuir;
    private javax.swing.JButton btnObservar;
    private javax.swing.JButton btnRegenera;
    private javax.swing.JButton btnSiguiente;
    private javax.swing.JButton btnVolver;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JLabel lblDefensa;
    private javax.swing.JLabel lblDescripcion;
    private javax.swing.JLabel lblEnLaMira;
    private javax.swing.JLabel lblExperiencia;
    private javax.swing.JLabel lblFondo;
    private javax.swing.JLabel lblGolpe;
    private javax.swing.JLabel lblImagenObjeto;
    private javax.swing.JLabel lblNivel;
    private javax.swing.JLabel lblNombre;
    private javax.swing.JLabel lblNumeroDefensa1;
    private javax.swing.JLabel lblNumeroGolpe;
    private javax.swing.JLabel lblNumeroNivel;
    private javax.swing.JLabel lblTextoIntro;
    private javax.swing.JLabel lblVida;
    private javax.swing.JTextPane txtpHistoria;
    // End of variables declaration//GEN-END:variables

    private void golpe() {

        int max = 5;
        int min = 1;
        PbVida.setValue((int) (PbVida.getValue() - Math.floor((Math.random() * max) + min)));
    }

    private void regenera() {

        int pociones = 10;

        int max = 3;
        int min = 1;

        if (pociones > 0) {

            PbVida.setValue((int) (PbVida.getValue() + Math.floor((Math.random() * max) + min)));

        } else {

            PbVida.setValue(PbVida.getValue() + 0);

        }

    }

    public void incrementaTexto() {

        txtpHistoria.setForeground(Color.WHITE);

////////LECTURA DE TXT Y SETEO EN LBLHISTORIA///////////////////////////////////
        File archivo = null;
        FileReader fr = null;
        BufferedReader br = null;

        try {
            // Apertura del fichero y creacion de BufferedReader para poder
            // hacer una lectura comoda (disponer del metodo readLine()).
            archivo = new File(ruta + "//archivo.txt");
            fr = new FileReader(archivo);
            br = new BufferedReader(fr);

            // Lectura del fichero
            String linea;
            linea = br.readLine();

            String acu = "";

            while ((linea = br.readLine()) != null) {

                String datosSeparados[] = linea.split("\\.");
//                boolean datosNpc = linea.contains("NPC1");
//
//                if (datosNpc = true) {
//                    txtpHistoria.setText("assdasaddsadsasadsadsadsdssdsadsadsasaasd");
//                }

                for (String valores : datosSeparados) {

                    txtpHistoria.setText(acu += valores + "\n");

//                    txtpHistoria.setText(datosSeparados[cont]);
//                    cont++;
                }

            }

        } catch (IOException e) {
        } finally {
            try {
                if (null != fr) {
                    fr.close();
                }
            } catch (IOException e2) {
            }
        }
////////////////////////////////////////////////////////////////////////////////// 

    }

}
